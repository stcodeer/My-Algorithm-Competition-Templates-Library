<html>
<head>
  <title>序列自动机的基本操作</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603450 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="779"/>
<h1>序列自动机的基本操作</h1>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">序列自动机即一种建立在序列上的有穷自动机。有字符集，状态集合，起始状态，接收状态集合，转移函数五个要素。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">其基本操作包括以下三种：</p>
<ol style="line-height: 160%; box-sizing: content-box; display: block; padding-left: 30px; margin: 6px 0 10px; color: #333; list-style-type: decimal;">
<li style="line-height: 160%; box-sizing: content-box;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">统计一个串本质不同的子序列的个数。(复杂度为<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.75em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1em; vertical-align: -0.25em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.02778em; -ms-high-contrast-adjust: none;">O</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∗</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∣</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.05764em; -ms-high-contrast-adjust: none;">S</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∣</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span></span></span></span>)</p>
</li>
<li style="line-height: 160%; box-sizing: content-box;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">查找一个子序列是否在该串中出现过。(复杂度为<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.75em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1em; vertical-align: -0.25em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.02778em; -ms-high-contrast-adjust: none;">O</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∗</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∣</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.05764em; -ms-high-contrast-adjust: none;">S</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∣</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span></span></span></span>)</p>
</li>
<li style="line-height: 160%; box-sizing: content-box;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">找到两个串所有的公共子序列。(复杂度为<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.75em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1em; vertical-align: -0.25em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.02778em; -ms-high-contrast-adjust: none;">O</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∗</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∗</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∣</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.05764em; -ms-high-contrast-adjust: none;">S</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">∣</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span></span></span></span>)</p>
</li>
</ol>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">这三种操作的状态集合即位置集合<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">0</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"> </span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span></span></span></span>，起始状态即位置<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">0</span></span></span></span>，接收状态集合为所有状态，转移函数和第一种操作的具体实现如下：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">void</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">prepare</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">()</span></span>{
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=n;i&gt;=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;--i){
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> j=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;j&lt;<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">26</span>;++j)nex[i][j]=nex[i+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>][j];
		nex[i][s[i]-<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'a'</span>]=i;
	}
}

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">dfs</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> x)</span></span>{
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(vis[x])<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> f[x];
	f[x]=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">26</span>;++i)
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(nex[x+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>][i]){
		f[x]+=dfs(nex[x+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>][i]);
	}
	vis[x]=<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">true</span>;
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> f[x];
}
<span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">/*
Sample &quot;abab&quot;:
Empty 
a
b
ab
ba
aa
bb
aba
bab
aab
abb
abab
*/</span>

</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%E5%BA%8F%E5%88%97%E8%87%AA%E5%8A%A8%E6%9C%BA%E5%8D%B3%E4%B8%80%E7%A7%8D%E5%BB%BA%E7%AB%8B%E5%9C%A8%E5%BA%8F%E5%88%97%E4%B8%8A%E7%9A%84%E6%9C%89%E7%A9%B7%E8%87%AA%E5%8A%A8%E6%9C%BA%E3%80%82%E6%9C%89%E5%AD%97%E7%AC%A6%E9%9B%86%EF%BC%8C%E7%8A%B6%E6%80%81%E9%9B%86%E5%90%88%EF%BC%8C%E8%B5%B7%E5%A7%8B%E7%8A%B6%E6%80%81%EF%BC%8C%E6%8E%A5%E6%94%B6%E7%8A%B6%E6%80%81%E9%9B%86%E5%90%88%EF%BC%8C%E8%BD%AC%E7%A7%BB%E5%87%BD%E6%95%B0%E4%BA%94%E4%B8%AA%E8%A6%81%E7%B4%A0%E3%80%82%0A%0A%E5%85%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%8C%85%E6%8B%AC%E4%BB%A5%E4%B8%8B%E4%B8%89%E7%A7%8D%EF%BC%9A%0A%0A1.%20%E7%BB%9F%E8%AE%A1%E4%B8%80%E4%B8%AA%E4%B8%B2%E6%9C%AC%E8%B4%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E5%AD%90%E5%BA%8F%E5%88%97%E7%9A%84%E4%B8%AA%E6%95%B0%E3%80%82(%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%BA%24O(n*%7CS%7C)%24)%0A%0A2.%20%E6%9F%A5%E6%89%BE%E4%B8%80%E4%B8%AA%E5%AD%90%E5%BA%8F%E5%88%97%E6%98%AF%E5%90%A6%E5%9C%A8%E8%AF%A5%E4%B8%B2%E4%B8%AD%E5%87%BA%E7%8E%B0%E8%BF%87%E3%80%82(%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%BA%24O(n*%7CS%7C)%24)%0A%0A3.%20%E6%89%BE%E5%88%B0%E4%B8%A4%E4%B8%AA%E4%B8%B2%E6%89%80%E6%9C%89%E7%9A%84%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97%E3%80%82(%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%BA%24O(n*n*%7CS%7C)%24)%0A%0A%E8%BF%99%E4%B8%89%E7%A7%8D%E6%93%8D%E4%BD%9C%E7%9A%84%E7%8A%B6%E6%80%81%E9%9B%86%E5%90%88%E5%8D%B3%E4%BD%8D%E7%BD%AE%E9%9B%86%E5%90%88%240~n%24%EF%BC%8C%E8%B5%B7%E5%A7%8B%E7%8A%B6%E6%80%81%E5%8D%B3%E4%BD%8D%E7%BD%AE%240%24%EF%BC%8C%E6%8E%A5%E6%94%B6%E7%8A%B6%E6%80%81%E9%9B%86%E5%90%88%E4%B8%BA%E6%89%80%E6%9C%89%E7%8A%B6%E6%80%81%EF%BC%8C%E8%BD%AC%E7%A7%BB%E5%87%BD%E6%95%B0%E5%92%8C%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%93%8D%E4%BD%9C%E7%9A%84%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%60%60%60c%2B%2B%0Avoid%20prepare()%7B%0A%09for(int%20i%3Dn%3Bi%3E%3D1%3B--i)%7B%0A%09%09for(int%20j%3D0%3Bj%3C26%3B%2B%2Bj)nex%5Bi%5D%5Bj%5D%3Dnex%5Bi%2B1%5D%5Bj%5D%3B%0A%09%09nex%5Bi%5D%5Bs%5Bi%5D-'a'%5D%3Di%3B%0A%09%7D%0A%7D%0A%0Aint%20dfs(int%20x)%7B%0A%09if(vis%5Bx%5D)return%20f%5Bx%5D%3B%0A%09f%5Bx%5D%3D1%3B%0A%09for(int%20i%3D0%3Bi%3C26%3B%2B%2Bi)%0A%09if(nex%5Bx%2B1%5D%5Bi%5D)%7B%0A%09%09f%5Bx%5D%2B%3Ddfs(nex%5Bx%2B1%5D%5Bi%5D)%3B%0A%09%7D%0A%09vis%5Bx%5D%3Dtrue%3B%0A%09return%20f%5Bx%5D%3B%0A%7D%0A%2F*%0ASample%20%22abab%22%3A%0AEmpty%20%0Aa%0Ab%0Aab%0Aba%0Aaa%0Abb%0Aaba%0Abab%0Aaab%0Aabb%0Aabab%0A*%2F%0A%0A%60%60%60</center></span>
</div></body></html> 