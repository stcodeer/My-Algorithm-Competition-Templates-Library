<html>
<head>
  <title>杜教筛</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603450 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1646"/>
<h1>杜教筛</h1>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">求<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.804292em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1.104002em; vertical-align: -0.29971000000000003em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Size1; position: relative; top: -0.0000050000000000050004em; -ms-high-contrast-adjust: none;">∑</span><span style="line-height: 160%; box-sizing: content-box; text-align: left; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.804292em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.40029em; margin-left: 0em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 2.7em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">i</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">=</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">1</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.2029em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 2.7em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px; -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.29971000000000003em; -ms-high-contrast-adjust: none;"></span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.16666666666666666em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">u</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">i</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span></span></span></span>和<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.804292em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1.104002em; vertical-align: -0.29971000000000003em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Size1; position: relative; top: -0.0000050000000000050004em; -ms-high-contrast-adjust: none;">∑</span><span style="line-height: 160%; box-sizing: content-box; text-align: left; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.804292em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.40029em; margin-left: 0em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 2.7em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">i</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">=</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">1</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.2029em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 2.7em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px; -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.29971000000000003em; -ms-high-contrast-adjust: none;"></span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.16666666666666666em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">p</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">h</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">i</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">i</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span></span></span></span></p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">#<span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">include</span><span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&lt;bits/stdc++.h&gt;</span></span>
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">using</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">namespace</span> <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">std</span>;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">typedef</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">long</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">long</span> ll;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">const</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> N = <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1e6</span>+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">5</span>;

<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> T;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> n;
<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">struct</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">fuc</span>{</span>
	ll u,phi;
	fuc(ll _u=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>,ll _phi=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>){
		u=_u;phi=_phi;
	}
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">friend</span> fuc <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">operator</span> - (fuc a,fuc b){
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> fuc(a.u-b.u,a.phi-b.phi);
	}
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">friend</span> fuc <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">operator</span> * (ll val,fuc a){
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> fuc(a.u*val,a.phi*val);
	}
}w[N];
<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">unordered_map</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>,fuc&gt;w_map;

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">void</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">prepare</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">()</span></span>{
	w[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>]=fuc(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>);
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">static</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">bool</span> vis[N];
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">static</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> p[N];
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>;i&lt;N;++i){
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(!vis[i]){
			p[++p[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>]]=i;
			w[i]=fuc(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>,i<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>);
		}
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> j=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;j&lt;=p[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>]&amp;&amp;p[j]*i&lt;N;++j){
			vis[i*p[j]]=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(i%p[j]==<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>){
				w[i*p[j]]=fuc(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>,w[i].phi*p[j]);
				<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">break</span>;
			}
			w[i*p[j]]=fuc(-w[i].u,w[i].phi*(p[j]<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>));
		}
	}
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>;i&lt;N;++i){
		w[i].u+=w[i<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>].u;
		w[i].phi+=w[i<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>].phi;
	}
}

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">fuc <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">Solve</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> n)</span></span>{
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(n&lt;N)<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> w[n];
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(w_map.find(n)!=w_map.end())<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> w_map[n];
	fuc ret=fuc(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1l</span>l*n*(n+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>)/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>);
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>,r;i&lt;=n;i=r+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>){
		r=n/(n/i);
		ret=ret<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1l</span>l*(r-i+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>)*Solve(n/i);
	}
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> w_map[n]=ret;
}

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">main</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">()</span></span>{
	prepare();
	<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">cin</span>&gt;&gt;T;
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">while</span>(T--){
		<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">cin</span>&gt;&gt;n;
		fuc ans=Solve(n);
		<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">printf</span>(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&quot;%lld %lld\n&quot;</span>,ans.phi,ans.u);
	}
}

</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%E6%B1%82%24%5Csum_%7Bi%3D1%7D%5En%20u(i)%24%E5%92%8C%24%5Csum_%7Bi%3D1%7D%5En%20phi(i)%24%0A%0A%60%60%60c%2B%2B%0A%23include%3Cbits%2Fstdc%2B%2B.h%3E%0Ausing%20namespace%20std%3B%0Atypedef%20long%20long%20ll%3B%0Aconst%20int%20N%20%3D%201e6%2B5%3B%0A%0Aint%20T%3B%0Aint%20n%3B%0Astruct%20fuc%7B%0A%09ll%20u%2Cphi%3B%0A%09fuc(ll%20_u%3D0%2Cll%20_phi%3D0)%7B%0A%09%09u%3D_u%3Bphi%3D_phi%3B%0A%09%7D%0A%09friend%20fuc%20operator%20-%20(fuc%20a%2Cfuc%20b)%7B%0A%09%09return%20fuc(a.u-b.u%2Ca.phi-b.phi)%3B%0A%09%7D%0A%09friend%20fuc%20operator%20*%20(ll%20val%2Cfuc%20a)%7B%0A%09%09return%20fuc(a.u*val%2Ca.phi*val)%3B%0A%09%7D%0A%7Dw%5BN%5D%3B%0Aunordered_map%3Cint%2Cfuc%3Ew_map%3B%0A%0Avoid%20prepare()%7B%0A%09w%5B1%5D%3Dfuc(1%2C1)%3B%0A%09static%20bool%20vis%5BN%5D%3B%0A%09static%20int%20p%5BN%5D%3B%0A%09for(int%20i%3D2%3Bi%3CN%3B%2B%2Bi)%7B%0A%09%09if(!vis%5Bi%5D)%7B%0A%09%09%09p%5B%2B%2Bp%5B0%5D%5D%3Di%3B%0A%09%09%09w%5Bi%5D%3Dfuc(-1%2Ci-1)%3B%0A%09%09%7D%0A%09%09for(int%20j%3D1%3Bj%3C%3Dp%5B0%5D%26%26p%5Bj%5D*i%3CN%3B%2B%2Bj)%7B%0A%09%09%09vis%5Bi*p%5Bj%5D%5D%3D1%3B%0A%09%09%09if(i%25p%5Bj%5D%3D%3D0)%7B%0A%09%09%09%09w%5Bi*p%5Bj%5D%5D%3Dfuc(0%2Cw%5Bi%5D.phi*p%5Bj%5D)%3B%0A%09%09%09%09break%3B%0A%09%09%09%7D%0A%09%09%09w%5Bi*p%5Bj%5D%5D%3Dfuc(-w%5Bi%5D.u%2Cw%5Bi%5D.phi*(p%5Bj%5D-1))%3B%0A%09%09%7D%0A%09%7D%0A%09for(int%20i%3D2%3Bi%3CN%3B%2B%2Bi)%7B%0A%09%09w%5Bi%5D.u%2B%3Dw%5Bi-1%5D.u%3B%0A%09%09w%5Bi%5D.phi%2B%3Dw%5Bi-1%5D.phi%3B%0A%09%7D%0A%7D%0A%0Afuc%20Solve(int%20n)%7B%0A%09if(n%3CN)return%20w%5Bn%5D%3B%0A%09if(w_map.find(n)!%3Dw_map.end())return%20w_map%5Bn%5D%3B%0A%09fuc%20ret%3Dfuc(1%2C1ll*n*(n%2B1)%2F2)%3B%0A%09for(int%20i%3D2%2Cr%3Bi%3C%3Dn%3Bi%3Dr%2B1)%7B%0A%09%09r%3Dn%2F(n%2Fi)%3B%0A%09%09ret%3Dret-1ll*(r-i%2B1)*Solve(n%2Fi)%3B%0A%09%7D%0A%09return%20w_map%5Bn%5D%3Dret%3B%0A%7D%0A%0Aint%20main()%7B%0A%09prepare()%3B%0A%09cin%3E%3ET%3B%0A%09while(T--)%7B%0A%09%09cin%3E%3En%3B%0A%09%09fuc%20ans%3DSolve(n)%3B%0A%09%09printf(%22%25lld%20%25lld%5Cn%22%2Cans.phi%2Cans.u)%3B%0A%09%7D%0A%7D%0A%0A%60%60%60</center></span>
</div></body></html> 