<html>
<head>
  <title>EXKMP</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603450 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2552"/>
<h1>EXKMP</h1>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.75em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1em; vertical-align: -0.25em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.10764em; -ms-high-contrast-adjust: none;">f</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">[</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">i</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">]</span></span></span></span>表示为模式串<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.43056em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.43056em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">s</span></span></span></span>中以<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.65952em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.65952em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">i</span></span></span></span>为起点的后缀字符串和模式串<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.43056em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.43056em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">s</span></span></span></span>的最长公共前缀长度。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果要求模式串<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">s</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">1</span></span></span></span>中的每个后缀字符串和模式串<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">s</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">2</span></span></span></span>的最长公共前缀长度，则把<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">s</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">1</span></span></span></span>接到<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.64444em; vertical-align: 0em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">s</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">2</span></span></span></span>后面即可（中间要有分隔符）。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">#<span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">include</span><span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&lt;bits/stdc++.h&gt;</span></span>
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">using</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">namespace</span> <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">std</span>;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">typedef</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">long</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">long</span> ll;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">const</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> N = <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">4e7</span>+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">5</span>;

<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> n,m,f[N];
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">char</span> s1[N],s2[N];

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">void</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">getfail</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">char</span> *s,<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> n)</span></span>{
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> a=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>,p=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
	f[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>]=n;
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;i&lt;n;++i){
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(i&gt;=p||i+f[i-a]&gt;=p){
			p=max(p,i);
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">while</span>(p&lt;n&amp;&amp;s[p]==s[p-i])p++;
			f[i]=p-i;
			a=i;
		}
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">else</span> f[i]=f[i-a];
	}
}

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">main</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">()</span></span>{
	<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">scanf</span>(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&quot;%s%s&quot;</span>,s1,s2);
	n=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">strlen</span>(s1);
	m=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">strlen</span>(s2);
	ll ans1=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>,ans2=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
	getfail(s2,m);
	s2[m]=<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'#'</span>;
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;i&lt;=n;++i)s2[m+i]=s1[i<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>];
	getfail(s2,m+n+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>);
}

</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%24f%5Bi%5D%24%E8%A1%A8%E7%A4%BA%E4%B8%BA%E6%A8%A1%E5%BC%8F%E4%B8%B2%24s%24%E4%B8%AD%E4%BB%A5%24i%24%E4%B8%BA%E8%B5%B7%E7%82%B9%E7%9A%84%E5%90%8E%E7%BC%80%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%A8%A1%E5%BC%8F%E4%B8%B2%24s%24%E7%9A%84%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%89%8D%E7%BC%80%E9%95%BF%E5%BA%A6%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%E8%A6%81%E6%B1%82%E6%A8%A1%E5%BC%8F%E4%B8%B2%24s1%24%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E5%90%8E%E7%BC%80%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%A8%A1%E5%BC%8F%E4%B8%B2%24s2%24%E7%9A%84%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%89%8D%E7%BC%80%E9%95%BF%E5%BA%A6%EF%BC%8C%E5%88%99%E6%8A%8A%24s1%24%E6%8E%A5%E5%88%B0%24s2%24%E5%90%8E%E9%9D%A2%E5%8D%B3%E5%8F%AF%EF%BC%88%E4%B8%AD%E9%97%B4%E8%A6%81%E6%9C%89%E5%88%86%E9%9A%94%E7%AC%A6%EF%BC%89%E3%80%82%0A%60%60%60c%2B%2B%0A%23include%3Cbits%2Fstdc%2B%2B.h%3E%0Ausing%20namespace%20std%3B%0Atypedef%20long%20long%20ll%3B%0Aconst%20int%20N%20%3D%204e7%2B5%3B%0A%0Aint%20n%2Cm%2Cf%5BN%5D%3B%0Achar%20s1%5BN%5D%2Cs2%5BN%5D%3B%0A%0Avoid%20getfail(char%20*s%2Cint%20n)%7B%0A%09int%20a%3D0%2Cp%3D0%3B%0A%09f%5B0%5D%3Dn%3B%0A%09for(int%20i%3D1%3Bi%3Cn%3B%2B%2Bi)%7B%0A%09%09if(i%3E%3Dp%7C%7Ci%2Bf%5Bi-a%5D%3E%3Dp)%7B%0A%09%09%09p%3Dmax(p%2Ci)%3B%0A%09%09%09while(p%3Cn%26%26s%5Bp%5D%3D%3Ds%5Bp-i%5D)p%2B%2B%3B%0A%09%09%09f%5Bi%5D%3Dp-i%3B%0A%09%09%09a%3Di%3B%0A%09%09%7D%0A%09%09else%20f%5Bi%5D%3Df%5Bi-a%5D%3B%0A%09%7D%0A%7D%0A%0Aint%20main()%7B%0A%09scanf(%22%25s%25s%22%2Cs1%2Cs2)%3B%0A%09n%3Dstrlen(s1)%3B%0A%09m%3Dstrlen(s2)%3B%0A%09ll%20ans1%3D0%2Cans2%3D0%3B%0A%09getfail(s2%2Cm)%3B%0A%09s2%5Bm%5D%3D'%23'%3B%0A%09for(int%20i%3D1%3Bi%3C%3Dn%3B%2B%2Bi)s2%5Bm%2Bi%5D%3Ds1%5Bi-1%5D%3B%0A%09getfail(s2%2Cm%2Bn%2B1)%3B%0A%7D%0A%0A%60%60%60</center></span>
</div></body></html> 