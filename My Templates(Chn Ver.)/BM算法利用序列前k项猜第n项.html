<html>
<head>
  <title>BM算法利用序列前k项猜第n项</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603450 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="641"/>
<h1>BM算法利用序列前k项猜第n项</h1>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.69444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.8888799999999999em; vertical-align: -0.19444em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.10764em; -ms-high-contrast-adjust: none;">f</span><span style="line-height: 160%; box-sizing: content-box; text-align: left; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.151392em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.5500000000000003em; margin-left: -0.10764em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 2.7em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px; -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.15em; -ms-high-contrast-adjust: none;"></span></span></span></span></span></span></span></span>不是线性递推式，那么不妨试试<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0; overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.75em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1em; vertical-align: -0.25em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.10764em; -ms-high-contrast-adjust: none;">f</span><span style="line-height: 160%; box-sizing: content-box; text-align: left; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.151392em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.5500000000000003em; margin-left: -0.10764em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 2.7em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px; -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.15em; -ms-high-contrast-adjust: none;"></span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">/</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">!</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">,</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.16666666666666666em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.10764em; -ms-high-contrast-adjust: none;">f</span><span style="line-height: 160%; box-sizing: content-box; text-align: left; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.151392em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.5500000000000003em; margin-left: -0.10764em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 2.7em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px; -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.15em; -ms-high-contrast-adjust: none;"></span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">/</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">n</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">−</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2222222222222222em; -ms-high-contrast-adjust: none;"></span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.03148em; -ms-high-contrast-adjust: none;">k</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">!</span></span></span></span>等公式。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">#<span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">include</span><span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&lt;bits/stdc++.h&gt;</span></span>
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">using</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">namespace</span> <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">std</span>;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">typedef</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">long</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">long</span> ll;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">const</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> N = <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1e4</span>+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">5</span>;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">const</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> mod = <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">998244353</span>;

<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> k,n;

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">ll <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">qpow</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(ll a,ll b)</span></span>{
	ll r=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">while</span>(b){
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(b&amp;<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>)r=r*a%mod;
		b&gt;&gt;=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
		a=a*a%mod;
	}
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> r;
}

<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">namespace</span> Linear_Seq{
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> k;
	ll a[N],h[N],s[N],t[N];
	<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; BM(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; x){
		<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; ls,cur;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> pn=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>,lf,ld;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;x.size();++i){
			ll t=-x[i]%mod;
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> j=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;j&lt;cur.size();++j){
				t=(t+x[i-j<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]*(ll)cur[j])%mod;
			}
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(!t)<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">continue</span>;
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(!cur.size()){
				cur.resize(i+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>);
				lf=i;
				ld=t;
				<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">continue</span>;
			}
			ll k=-t*qpow(ld,mod<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-2</span>)%mod;
			<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; c(i-lf<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>);
			c.push_back(-k);
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> j=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;j&lt;ls.size();++j)c.push_back(ls[j]*k%mod);
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(c.size()&lt;cur.size())c.resize(cur.size());
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> j=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;j&lt;cur.size();++j)c[j]=(c[j]+cur[j])%mod;
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(i-lf+ls.size()&gt;=cur.size()){
				ls=cur;
				lf=i;
				ld=t;
			}
			cur=c;
		}
		<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; &amp;o=cur;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;o.size();++i)o[i]=(o[i]%mod+mod)%mod;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> o;
	}
	
	<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">void</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">mull</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(ll *p,ll *q)</span></span>{
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">static</span> ll w[N];
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*k;++i)w[i]=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;k;++i)
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(p[i]){
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> j=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;j&lt;k;++j){
				w[i+j]=(w[i+j]+p[i]*q[j])%mod;
			}
		}
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*k<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>;i&gt;=k;--i)
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(w[i]){
			<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> j=k<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>;~j;--j){
				w[i-j<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]=(w[i-j<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]+w[i]*h[j])%mod;
			}
		}
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;k;++i)p[i]=w[i];
	}
	
	<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">ll <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">calc</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(ll K)</span></span>{
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=k;~i;--i)s[i]=t[i]=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
		s[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>]=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(k!=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>)t[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>]=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">else</span> t[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>]=h[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>];
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(;K;mull(t,t),K&gt;&gt;=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>)
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(K&amp;<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>){
			mull(s,t);
		}
		ll ret=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;k;++i)ret=(ret+s[i]*a[i])%mod;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> (ret%mod+mod)%mod;
	}
	
	<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">get</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; x,ll n)</span></span>{
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(n&lt;x.size())<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> x[n];
		<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; v=BM(x);<span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">//表示最短递推式</span>
		k=v.size();
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span>(!k)<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;i&lt;k;++i){
			h[i]=v[i];
			a[i]=x[i];
		}
		<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> calc(n);
	}
}

<span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">main</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">()</span></span>{
	<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">cin</span>&gt;&gt;k&gt;&gt;n;
	<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">vector</span>&lt;<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span>&gt; v;
	<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">int</span> i=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>,x;i&lt;k;++i){
		<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">cin</span>&gt;&gt;x;
		v.push_back(x);
	}
	<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">cout</span>&lt;&lt;Linear_Seq::get(v,n)&lt;&lt;<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">endl</span>;
}
</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%E5%A6%82%E6%9E%9C%24f_n%24%E4%B8%8D%E6%98%AF%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8%E5%BC%8F%EF%BC%8C%E9%82%A3%E4%B9%88%E4%B8%8D%E5%A6%A8%E8%AF%95%E8%AF%95%24f_n%2Fn!%2Cf_n%2F(n-k)!%24%E7%AD%89%E5%85%AC%E5%BC%8F%E3%80%82%0A%0A%60%60%60c%2B%2B%0A%23include%3Cbits%2Fstdc%2B%2B.h%3E%0Ausing%20namespace%20std%3B%0Atypedef%20long%20long%20ll%3B%0Aconst%20int%20N%20%3D%201e4%2B5%3B%0Aconst%20int%20mod%20%3D%20998244353%3B%0A%0Aint%20k%2Cn%3B%0A%0All%20qpow(ll%20a%2Cll%20b)%7B%0A%09ll%20r%3D1%3B%0A%09while(b)%7B%0A%09%09if(b%261)r%3Dr*a%25mod%3B%0A%09%09b%3E%3E%3D1%3B%0A%09%09a%3Da*a%25mod%3B%0A%09%7D%0A%09return%20r%3B%0A%7D%0A%0Anamespace%20Linear_Seq%7B%0A%09int%20k%3B%0A%09ll%20a%5BN%5D%2Ch%5BN%5D%2Cs%5BN%5D%2Ct%5BN%5D%3B%0A%09vector%3Cint%3E%20BM(vector%3Cint%3E%20x)%7B%0A%09%09vector%3Cint%3E%20ls%2Ccur%3B%0A%09%09int%20pn%3D0%2Clf%2Cld%3B%0A%09%09for(int%20i%3D0%3Bi%3Cx.size()%3B%2B%2Bi)%7B%0A%09%09%09ll%20t%3D-x%5Bi%5D%25mod%3B%0A%09%09%09for(int%20j%3D0%3Bj%3Ccur.size()%3B%2B%2Bj)%7B%0A%09%09%09%09t%3D(t%2Bx%5Bi-j-1%5D*(ll)cur%5Bj%5D)%25mod%3B%0A%09%09%09%7D%0A%09%09%09if(!t)continue%3B%0A%09%09%09if(!cur.size())%7B%0A%09%09%09%09cur.resize(i%2B1)%3B%0A%09%09%09%09lf%3Di%3B%0A%09%09%09%09ld%3Dt%3B%0A%09%09%09%09continue%3B%0A%09%09%09%7D%0A%09%09%09ll%20k%3D-t*qpow(ld%2Cmod-2)%25mod%3B%0A%09%09%09vector%3Cint%3E%20c(i-lf-1)%3B%0A%09%09%09c.push_back(-k)%3B%0A%09%09%09for(int%20j%3D0%3Bj%3Cls.size()%3B%2B%2Bj)c.push_back(ls%5Bj%5D*k%25mod)%3B%0A%09%09%09if(c.size()%3Ccur.size())c.resize(cur.size())%3B%0A%09%09%09for(int%20j%3D0%3Bj%3Ccur.size()%3B%2B%2Bj)c%5Bj%5D%3D(c%5Bj%5D%2Bcur%5Bj%5D)%25mod%3B%0A%09%09%09if(i-lf%2Bls.size()%3E%3Dcur.size())%7B%0A%09%09%09%09ls%3Dcur%3B%0A%09%09%09%09lf%3Di%3B%0A%09%09%09%09ld%3Dt%3B%0A%09%09%09%7D%0A%09%09%09cur%3Dc%3B%0A%09%09%7D%0A%09%09vector%3Cint%3E%20%26o%3Dcur%3B%0A%09%09for(int%20i%3D0%3Bi%3Co.size()%3B%2B%2Bi)o%5Bi%5D%3D(o%5Bi%5D%25mod%2Bmod)%25mod%3B%0A%09%09return%20o%3B%0A%09%7D%0A%09%0A%09void%20mull(ll%20*p%2Cll%20*q)%7B%0A%09%09static%20ll%20w%5BN%5D%3B%0A%09%09for(int%20i%3D0%3Bi%3C2*k%3B%2B%2Bi)w%5Bi%5D%3D0%3B%0A%09%09for(int%20i%3D0%3Bi%3Ck%3B%2B%2Bi)%0A%09%09if(p%5Bi%5D)%7B%0A%09%09%09for(int%20j%3D0%3Bj%3Ck%3B%2B%2Bj)%7B%0A%09%09%09%09w%5Bi%2Bj%5D%3D(w%5Bi%2Bj%5D%2Bp%5Bi%5D*q%5Bj%5D)%25mod%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%09for(int%20i%3D2*k-1%3Bi%3E%3Dk%3B--i)%0A%09%09if(w%5Bi%5D)%7B%0A%09%09%09for(int%20j%3Dk-1%3B~j%3B--j)%7B%0A%09%09%09%09w%5Bi-j-1%5D%3D(w%5Bi-j-1%5D%2Bw%5Bi%5D*h%5Bj%5D)%25mod%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%09for(int%20i%3D0%3Bi%3Ck%3B%2B%2Bi)p%5Bi%5D%3Dw%5Bi%5D%3B%0A%09%7D%0A%09%0A%09ll%20calc(ll%20K)%7B%0A%09%09for(int%20i%3Dk%3B~i%3B--i)s%5Bi%5D%3Dt%5Bi%5D%3D0%3B%0A%09%09s%5B0%5D%3D1%3B%0A%09%09if(k!%3D1)t%5B1%5D%3D1%3B%0A%09%09else%20t%5B0%5D%3Dh%5B0%5D%3B%0A%09%09for(%3BK%3Bmull(t%2Ct)%2CK%3E%3E%3D1)%0A%09%09if(K%261)%7B%0A%09%09%09mull(s%2Ct)%3B%0A%09%09%7D%0A%09%09ll%20ret%3D0%3B%0A%09%09for(int%20i%3D0%3Bi%3Ck%3B%2B%2Bi)ret%3D(ret%2Bs%5Bi%5D*a%5Bi%5D)%25mod%3B%0A%09%09return%20(ret%25mod%2Bmod)%25mod%3B%0A%09%7D%0A%09%0A%09int%20get(vector%3Cint%3E%20x%2Cll%20n)%7B%0A%09%09if(n%3Cx.size())return%20x%5Bn%5D%3B%0A%09%09vector%3Cint%3E%20v%3DBM(x)%3B%2F%2F%E8%A1%A8%E7%A4%BA%E6%9C%80%E7%9F%AD%E9%80%92%E6%8E%A8%E5%BC%8F%0A%09%09k%3Dv.size()%3B%0A%09%09if(!k)return%200%3B%0A%09%09for(int%20i%3D0%3Bi%3Ck%3B%2B%2Bi)%7B%0A%09%09%09h%5Bi%5D%3Dv%5Bi%5D%3B%0A%09%09%09a%5Bi%5D%3Dx%5Bi%5D%3B%0A%09%09%7D%0A%09%09return%20calc(n)%3B%0A%09%7D%0A%7D%0A%0Aint%20main()%7B%0A%09cin%3E%3Ek%3E%3En%3B%0A%09vector%3Cint%3E%20v%3B%0A%09for(int%20i%3D0%2Cx%3Bi%3Ck%3B%2B%2Bi)%7B%0A%09%09cin%3E%3Ex%3B%0A%09%09v.push_back(x)%3B%0A%09%7D%0A%09cout%3C%3CLinear_Seq%3A%3Aget(v%2Cn)%3C%3Cendl%3B%0A%7D%0A%60%60%60</center></span>
</div></body></html> 